{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block extrahead %}
    {{ form.media }}
{% endblock %}

{% block content %}

{% if no_query %}
<h1>Please Enter Search Criteria into Search Bar!</h1>

{% else %}
{% if user.is_authenticated %}
{% if event_list %}
<div class="container text-center">
<h1>Search Results for: "{{ query }}"</h1>
</div>

<form method="POST" action="{% url 'events:search_results' %}" style="text-align: center;">
    {% csrf_token %}
    Sort By:
    <input type="checkbox" id="name" {% if "name" in criteria %}checked{% endif %} name="criteria" value="name">
    <label for="name">Name</label>
    <input type="checkbox" id="tags" {% if "tags" in criteria %}checked{% endif %} name="criteria" value="tags">
    <label for="tags">Tags</label>
    <input type="checkbox" id="location" {% if "location" in criteria %}checked{% endif %} name="criteria" value="location">
    <label for="location">Location</label>
    <input type="submit" class="btn btn-success btn-sm" value="Filter">
</form> 

<style>
    li{
        font-size: 25px;
    }
    a:hover {
        color: #f6d6ad;
    }
    a {
        color: #ffd57e;
    }
    footer{
        position:absolute;
    }
</style>

<ul class="list-group">
    {% for event in event_list %}
        <li class="list-group-item">
            <a href="{% url 'events:detail' event.id %}">{{ event.name | title }}</a>
            {% if event.author == request.user.username %}
                <div style="display:inline; float: right;">
                    <a href="{% url 'events:edit_event' event.id %}" class="btn btn-primary btn-sm">Edit</a>
                    <a href="{% url 'events:delete_event' event.id %}" class="btn btn-danger btn-sm">Delete</a>
                    </div>
            {% endif %}
        </li>
    {% endfor %}
</ul>

{% else %}
    {% if criteria %}
    <div class="container text-center">
        <h1>Search Results for: "{{ query }}"</h1>
        </div>
        
        <form method="POST" action="{% url 'events:search_results' %}" style="text-align: center;">
            {% csrf_token %}
            Sort By:
            <input type="checkbox" id="name" {% if "name" in criteria %}checked{% endif %} name="criteria" value="name">
            <label for="name">Name</label>
            <input type="checkbox" id="tags" {% if "tags" in criteria %}checked{% endif %} name="criteria" value="tags">
            <label for="tags">Tags</label>
            <input type="checkbox" id="location" {% if "location" in criteria %}checked{% endif %} name="criteria" value="location">
            <label for="location">Location</label>
            <input type="submit" value="Filter">
        </form> 
        
        <style>
            li{
                font-size: 25px;
            }
            a:hover {
                color: #f6d6ad;
            }
            a {
                color: #ffd57e;
            }
            footer{
                position:absolute;
            }
        </style>
        <div class="container text-center">
        <p>No events...</p>
        </div>
    {% else %}
    <h1>No Results for "{{ query }}"... Try Another Search!</h1>
    {% endif %}
{% endif %}

{% else %}
<link href="https://fonts.googleapis.com/css2?family=Zilla+Slab:wght@300&display=swap" rel="stylesheet">
       <style>
       body {
         background-image: url("{% static 'cat.jpg' %}");
         background-size:1600px 900px;
       }
       h1{
           color:#D17B43;
           font-family: 'Zilla Slab',serif;
           font-size: 50px;
       }
       p{
           color:#B58F12;
           font-family: 'Zilla Slab',serif;
           font-size: 26px;
       }
       footer {
           bottom: 0;
           width:100%;
           position: absolute;
       }
       </style>
      <div class="container text-center">
      <h1>Search for Events</h1>
      <p>Log in to find public events created by people within your community and around the world!</p>
      </div>
{% endif %}
{% endif %}
{% endblock %}
