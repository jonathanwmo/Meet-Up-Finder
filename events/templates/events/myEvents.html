{% extends "base.html" %}
{% load static %}
{% block content %}
{% load events_extras %}

<link rel="stylesheet" href="{% static 'events/css/style.css' %}">

<!-- This site crashes when a user that is not logged in tries to access -->
{% if user.is_authenticated %}

<style>
.wrapper {
  min-height: 100%;
  margin-bottom: -50px;
}
.footer{
    position: absolute;
    bottom: 0;
}
.push {
  height: 50px;
}

.modal {
  padding-top: 100px;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
}
.modal-content {
  margin: auto;
  padding: 20px;
  border: 1px solid;
  width: 80%;
}
.close {
  color: #aaaaaa;
  float: right;
  font-size: 30px;
}
.close:hover,
.close:focus {
  color: #000;
  cursor: pointer;
}
.deleteBtn{
    background-color: red;
    color:white;
    border-radius: 4px;
    border: 0px ;
    padding: 5px 5px;
    font-size:15px;
}
</style>


<br>
<div class="accordion" id="event-accordian">
    <div class="card">
      <div class="card-header" id="headingOne">
        <h2 class="mb-0">
          <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" style="color:#D17B43">
            Events You Made
          </button>
        </h2>
      </div>
  
      <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#event-accordian">
        <div class="card-body">
            <ul class="list-group list-group-flush">
              {% if made %}
                {% for event in made %}
                  <li class="list-group-item">
                      <a href="{% url 'events:detail' event.id %}">{{ event.name | title }}</a>
                      <div style="display:inline; float: right;">
                      <a href="{% url 'events:edit_event' event.id %}" class="btn btn-primary btn-sm">Edit</a>
                       
                      <button class="deleteBtn">Delete</button>
                      <div id="Modal" class="modal">
                        <div class="modal-content">
                          <p class="close">&times;</p>
                          <p> You are deleting this event! Click delete to confirm. </p>
                         <a href="{% url 'events:delete_event' event.id %}" class="btn btn-danger btn-sm">Delete</a>
                        </div>
                      </div>

                      </div>
                  </li>
                {% endfor %}
              {% else %}
                <p>None yet!</p>
              {% endif %}
            </ul>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header" id="headingTwo">
        <h2 class="mb-0">
          <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="color:#D17B43">
            Events You Bookmarked
          </button>
        </h2>
      </div>
      <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#event-accordian">
        <div class="card-body">
            {% if bookmark %}
                <ul class="list-group list-group-flush">
                    {% for event in bookmark %}
                    <li class="list-group-item"><a href="{% url 'events:detail' event.id %}">{{ event.name | title }}</a></li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>None yet!</p>
            {% endif %}
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header" id="headingThree">
        <h2 class="mb-0">
          <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree" style="color:#D17B43">
            Events You Signed Up For
          </button>
        </h2>
      </div>
      <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#event-accordian">
        <div class="card-body">
            {% if attendees %}
                <ul class="list-group list-group-flush">
                    {% for event in attendees %}
                        <li class="list-group-item"><a href="{% url 'events:detail' event.id %}">{{ event.name | title }}</a></li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>None yet!</p>
            {% endif %}
        </div>
      </div>
    </div>
    <style>
        a:hover {
            color: #e5c5b5;
        }
        a{
            font-size:19px;
            color: #d49a89;
        }
    </style>
    <!-- Only show if invited to any events -->
    {% if invite %}
    <div class="card">
        <div class="card-header" id="headingFour">
          <h2 class="mb-0">
            <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour" style="color:#D17B43">
              Events You Are Invited To
            </button>
          </h2>
        </div>
        <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#event-accordian">
          <div class="card-body">
            <ul class="list-group list-group-flush">
                {% for event in invite %}
                    <li class="list-group-item"><a href="{% url 'events:detail' event.id %}">{{ event.name | title }}</a></li>
                {% endfor %}
        </ul>
          </div>
        </div>
      </div>
      {% endif %}
  </div>
<div class="editable-alias" style="display:block; height: 310px; width: 100%;">&nbsp;</div>


<script>
var modal = document.getElementById("Modal");
var x = document.getElementsByClassName("close");
var buttons = document.getElementsByClassName('deleteBtn');
for(var i=0; i<buttons.length; i++){
    buttons[i].addEventListener("click", function() {
      modal.style.display = "block";
    })
}
for(var i=0; i<x.length; i++){
    x[i].addEventListener("click", function() {
      modal.style.display = "none";
    })
}
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>
  
 
 

{% else %}
    <link href="https://fonts.googleapis.com/css2?family=Zilla+Slab:wght@300&display=swap" rel="stylesheet">
         <style>
         body {
           background-image: url("{% static 'cat.jpg' %}");
           background-size:1600px 900px;
         }
         h1{
             color:#D17B43;
             font-family: 'Zilla Slab',serif;
             font-size: 50px;
         }
         p{
             color:#B58F12;
             font-family: 'Zilla Slab',serif;
             font-size: 25px;
         }
         footer {
             bottom: 0;
             width:100%;
             position: absolute;
         }
         #fixed-height {
            height: 100px;
            background-color: #57c975;
          }
          #remaining-height {
          background-color: #d9deda;
          position: absolute;
          top: 100px;
          bottom: 0;
          width: 100%;
        }
        </style>

        <div class="container text-center">
        <h1>Events</h1>
        <p>This page will show all your events, including ones you've created, were invited to, are interested in, and are attending! This is also where you can edit and delete previous events you have made. Once an event is edited, all attendees will be notified about the changes via email. </p>
        </div>
{% endif %}
{% endblock %}
